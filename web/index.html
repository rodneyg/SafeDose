<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta httpEquiv="X-UA-Compatible" content="IE=edge" />
  <!-- Ultra-aggressive viewport meta tag to completely prevent zooming and layout scaling on mobile -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, shrink-to-fit=no, viewport-fit=cover, interactive-widget=resizes-content" />
  <title>SafeDose</title>
  <style>
    /* Ultra-aggressive global styles to prevent any viewport scaling or horizontal scrolling */
    html, body {
      overflow: hidden !important;
      width: 100vw !important;
      max-width: 100vw !important;
      margin: 0 !important;
      padding: 0 !important;
      position: relative;
      /* Prevent font scaling that can trigger zoom */
      -webkit-text-size-adjust: none !important;
      -moz-text-size-adjust: none !important;
      -ms-text-size-adjust: none !important;
      text-size-adjust: none !important;
      /* Prevent overflow scrolling */
      -webkit-overflow-scrolling: touch !important;
      /* Prevent selection and context menus that can trigger zoom */
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      /* Prevent touch callouts */
      -webkit-touch-callout: none;
      /* Lock transformations */
      transform: none !important;
      transform-origin: 0 0 !important;
    }
    #root {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      width: 100vw !important;
      overflow: hidden !important;
      max-width: 100vw !important;
      /* Ensure no transforms or scaling */
      transform: none !important;
      transform-origin: 0 0 !important;
    }
    /* Prevent zoom on input focus for all input types */
    input, textarea, select {
      font-size: 16px !important; /* Prevents zoom on iOS */
      max-width: 100% !important;
      box-sizing: border-box !important;
      /* Restore text selection for inputs */
      -webkit-user-select: text;
      -moz-user-select: text;
      -ms-user-select: text;
      user-select: text;
    }
  </style>
  <script>
    // Ultra-aggressive JavaScript fallback to prevent viewport scaling and ensure layout stability
    document.addEventListener('DOMContentLoaded', function() {
      // Force viewport meta tag values programmatically as fallback
      const viewport = document.querySelector('meta[name=viewport]');
      if (viewport) {
        viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, shrink-to-fit=no, viewport-fit=cover, interactive-widget=resizes-content');
      }
      
      // Dynamic height adjustment using visual viewport API
      const updateHeight = () => {
        const viewportHeight = window.visualViewport?.height || window.innerHeight;
        console.log('[ViewportHeight] HTML updating height to:', viewportHeight);
        
        document.body.style.height = `${viewportHeight}px`;
        document.body.style.maxHeight = `${viewportHeight}px`;
        document.documentElement.style.height = `${viewportHeight}px`;
        document.documentElement.style.maxHeight = `${viewportHeight}px`;
        
        const root = document.getElementById('root');
        if (root) {
          root.style.height = `${viewportHeight}px`;
          root.style.maxHeight = `${viewportHeight}px`;
        }
      };
      
      // Aggressive body and html locking with dynamic height
      const lockLayout = () => {
        document.body.style.overflow = 'hidden';
        document.body.style.width = '100vw';
        document.body.style.maxWidth = '100vw';
        document.body.style.position = 'fixed';
        document.body.style.top = '0';
        document.body.style.left = '0';
        document.body.style.margin = '0';
        document.body.style.padding = '0';
        document.body.style.webkitTextSizeAdjust = 'none';
        document.body.style.transform = 'none';
        
        document.documentElement.style.overflow = 'hidden';
        document.documentElement.style.width = '100vw';
        document.documentElement.style.maxWidth = '100vw';
        document.documentElement.style.webkitTextSizeAdjust = 'none';
        document.documentElement.style.transform = 'none';
        
        // Apply dynamic height
        updateHeight();
      };
      
      // Initial lock
      lockLayout();
      
      // Re-lock on window resize and visual viewport changes
      window.addEventListener('resize', updateHeight);
      
      // Add visual viewport listeners for dynamic height adjustment
      if (window.visualViewport) {
        window.visualViewport.addEventListener('resize', updateHeight);
        window.visualViewport.addEventListener('scroll', updateHeight);
      }
      
      // Disable zoom on double tap
      let lastTouchEnd = 0;
      document.addEventListener('touchend', function (event) {
        const now = (new Date()).getTime();
        if (now - lastTouchEnd <= 300) {
          event.preventDefault();
        }
        lastTouchEnd = now;
      }, false);
      
      // Prevent zoom with gesture events
      document.addEventListener('gesturestart', function (event) {
        event.preventDefault();
      }, false);
      
      document.addEventListener('gesturechange', function (event) {
        event.preventDefault();
      }, false);
      
      document.addEventListener('gestureend', function (event) {
        event.preventDefault();
      }, false);
      
      // Ultra-aggressive focus/blur handlers to prevent layout changes during keyboard interaction
      document.addEventListener('focusin', function(event) {
        if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') {
          console.log('[ViewportLock] Input focused - applying aggressive lock');
          lockLayout();
          
          // Force input font size to prevent zoom
          if (event.target.style.fontSize !== '16px') {
            event.target.style.fontSize = '16px';
          }
          
          // Prevent any transforms on the input
          event.target.style.transform = 'none';
          event.target.style.webkitTransform = 'none';
        }
      });
      
      document.addEventListener('focusout', function(event) {
        if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') {
          console.log('[ViewportLock] Input blurred - maintaining lock');
          // Keep layout locked even after focus out
          setTimeout(lockLayout, 100);
        }
      });
      
      // Prevent any scaling via touch events
      document.addEventListener('touchstart', function(event) {
        if (event.touches.length > 1) {
          event.preventDefault();
        }
      }, { passive: false });
      
      document.addEventListener('touchmove', function(event) {
        if (event.touches.length > 1) {
          event.preventDefault();
        }
      }, { passive: false });
    });
  </script>
</head>
<body>
  <div id="root"></div>
</body>
</html>